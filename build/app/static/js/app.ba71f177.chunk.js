"use strict";(self.webpackChunk_dhis2_app_shell=self.webpackChunk_dhis2_app_shell||[]).push([[2143],{8593:function(e,t,a){a.r(t),a.d(t,{default:function(){return T}});var n=a(969),l=a(1949),r=(a(4144),"App_desgin__1c78E"),i="App_zebraStriping__zBtUM",o="App_darkTable__ohDSI",s="App_lightTable__6Pf8+",u="App_light-mode__AE4fG",c="App_dark-mode__fIzxz",d="App_itemAlign__AEBX2",m="App_searchBackground__f5cZe",v=(a(4551),a(6309)),E=a(8382),p=a(964),g=a(3582),f=a(4359),y=a(7212),k="Model_modal__wrap__x3xy-",b="Model_visible__sINfZ",h="Model_modal__sifuU";var S=e=>{let{modalStyle:t,children:a,show:l,onClose:r,backdropStyle:i}=e;const o=(0,n.useRef)(null);return(0,n.useEffect)((()=>{l?o.current.classList.add(b):o.current.classList.remove(b)}),[l]),n.createElement(n.Fragment,null,n.createElement("div",{ref:o,className:`${k}`,onClick:r},n.createElement("div",{style:t,className:`${h} flex flex-col`},n.createElement("button",{onClick:r,className:"ml-auto py-0 px-2",style:{border:"none",background:"#e5e5e5"}},n.createElement("i",{class:"fa-solid fa-xmark bold",style:{color:"#444",fontSize:"14px"}})),a)))};function A(e,t,a){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class _{}A(_,"EventAPi",(async(e,t)=>(await fetch(`../../events.json?skipPaging=true&program=${e}&trackedEntityInstance=${t.id}&fields=dataValues[dataElement,value],eventDate,programStage,status`,{method:"GET"})).json())),A(_,"ProgramStages",(async()=>(await fetch("../../programStages.json?paging=false&fields=id,name",{method:"GET"})).json())),A(_,"AllDataelement",(async()=>(await fetch("../../dataElements.json?paging=false&domainType=TRACKER&fields=id,name",{method:"GET"})).json())),A(_,"Programoptions",(async()=>(await fetch("../../29/sqlViews/oZAXWFlZgI7/data?paging=false",{method:"GET"})).json())),A(_,"tableDataplot",(async e=>(await fetch(`../../trackedEntityInstances.json?ou=Fn51zf6ifbm&program=${encodeURIComponent(e)}&ouMode=DESCENDANTS`,{method:"GET"})).json())),A(_,"tableHeaderData",(async e=>(await fetch(`../../programs/${e}.json?fields=programTrackedEntityAttributes%5BtrackedEntityAttribute%5Bid,name,formName,attributeValues%5Battribute%5Bid,name,code%5D,value%5D%5D%5D`,{method:"GET"})).json()));var w=()=>{var e,t,a;const[l,k]=(0,n.useState)([]),[b,h]=(0,n.useState)(""),[A,w]=(0,n.useState)([]),[x,T]=(0,n.useState)(""),[N,D]=(0,n.useState)(!1),[C,I]=(0,n.useState)([]),[P,j]=(0,n.useState)([]),[R,B]=(0,n.useState)({}),[$,M]=(0,n.useState)({value:!1,id:""}),[W,G]=(0,n.useState)([]),[V,F]=(0,n.useState)([]),[O,Z]=(0,n.useState)([]),[z,L]=(0,n.useState)(""),[U,H]=(0,n.useState)("true"===localStorage.getItem("darkMode"));(0,n.useEffect)((()=>{localStorage.setItem("darkMode",U)}),[U]);(0,n.useRef)(null);const q=function(e,t,a){e.nodeType||(e=document.getElementById(e));var n,l={worksheet:t||"Worksheet",table:e.innerHTML};document.getElementById("dlink").href="data:application/vnd.ms-excel;base64,"+function(e){return window.btoa(unescape(encodeURIComponent(e)))}((n=l,'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body><table>{table}</table></body></html>'.replace(/{(\w+)}/g,(function(e,t){return n[t]})))),document.getElementById("dlink").download=`${t}.xls`,document.getElementById("dlink").click()};console.log("programStages>>>>>>>",V),console.log("eventData>>>>>",W),console.log("dataElements>>>>>>",O),(0,n.useEffect)((()=>{1==$.value&&async function(){const e=await _.EventAPi(b,$);G(e)}()}),[$]),(0,n.useEffect)((()=>{!async function(){var e;const t=await _.Programoptions();k(null===t||void 0===t||null===(e=t.listGrid)||void 0===e?void 0:e.rows)}(),async function(){const e=await _.ProgramStages(),t=await _.AllDataelement();F(e),Z(t)}()}),[]),(0,n.useEffect)((()=>{!async function(){var e;const t=await _.tableDataplot(b);w(null===t||void 0===t?void 0:t.trackedEntityInstances),T(null===t||void 0===t||null===(e=t.trackedEntityInstances)||void 0===e?void 0:e.length)}(),async function(){const e=await _.tableHeaderData(b);I(e)}()}),[b]),(0,n.useEffect)((()=>{!function(e){const t=[];if(void 0!==(null===e||void 0===e?void 0:e.programTrackedEntityAttributes))for(var a=0;a<e.programTrackedEntityAttributes.length;a++){var n,l;if(void 0!==(null===(n=e.programTrackedEntityAttributes[a])||void 0===n||null===(l=n.trackedEntityAttribute)||void 0===l?void 0:l.attributeValues))for(var r=0;r<e.programTrackedEntityAttributes[a].trackedEntityAttribute.attributeValues.length;r++){var i,o,s;if("showInConsent"===(null===(i=e.programTrackedEntityAttributes[a].trackedEntityAttribute.attributeValues[r])||void 0===i||null===(o=i.attribute)||void 0===o?void 0:o.code)&&"true"===(null===(s=e.programTrackedEntityAttributes[a].trackedEntityAttribute.attributeValues[r])||void 0===s?void 0:s.value)){const n={attribute:e.programTrackedEntityAttributes[a].trackedEntityAttribute.id,displayName:e.programTrackedEntityAttributes[a].trackedEntityAttribute.name,value:""};t.push(n),j(t),console.log("getting the Blank array data",t)}}}}(C)}),[C]);const[J,X]=(0,n.useState)(1);return n.createElement(n.Fragment,null,n.createElement("div",{className:U?c:u,style:{overflow:"auto"}},n.createElement("div",{style:{padding:"5px"}},n.createElement("div",null,l.length>0&&n.createElement("select",{onChange:e=>{const t=JSON.parse(e.target.value);h(t.id),L(t.name)}},n.createElement("option",{value:""},"Select Program for Event List"),l.map((e=>n.createElement("option",{key:e[0],value:JSON.stringify({id:e[0],name:e[1]})},e[1])))),n.createElement("button",{onClick:()=>{H(!U)}},U?"Light Mode":"Dark Mode"),n.createElement("button",{onClick:()=>q("report-table","Timor Event List")},"Export Data")),n.createElement(S,{show:$.value,onClose:()=>M({value:!1})},n.createElement(p.i,{className:U?o:s},n.createElement(v.S,null,n.createElement(E.p,null,"Selected Program:"),n.createElement(E.p,null,z||"")),null===W||void 0===W||null===(e=W.events)||void 0===e?void 0:e.map(((e,t)=>{var a,l;return n.createElement("div",null,n.createElement(v.S,null,n.createElement(E.p,null,"Program Stage:"),n.createElement(E.p,null,(e=>{var t;const a=null===V||void 0===V||null===(t=V.programStages)||void 0===t?void 0:t.find((t=>t.id===e));return a?a.name:"Unknown"})(null===e||void 0===e?void 0:e.programStage))),n.createElement(v.S,{className:i},n.createElement(E.p,null,"Event Date:"),n.createElement(E.p,null,e.eventDate?e.eventDate.split("T")[0]:"")),n.createElement(v.S,null,n.createElement(E.p,null,"Status:"),n.createElement(E.p,null,e.status)),(null===e||void 0===e||null===(a=e.dataValues)||void 0===a?void 0:a.length)>0&&n.createElement(n.Fragment,null,n.createElement("span",null,"DataElements"),n.createElement(v.S,{className:i},null===e||void 0===e||null===(l=e.dataValues)||void 0===l?void 0:l.map(((e,t)=>n.createElement(v.S,{key:t,className:i},n.createElement(E.p,null,(e=>{var t;const a=null===O||void 0===O||null===(t=O.dataElements)||void 0===t?void 0:t.find((t=>t.id===e));return a?a.name:"Unknown"})(null===e||void 0===e?void 0:e.dataElement),":"),n.createElement(E.p,null," ",e.value)))))))})))),n.createElement("div",{className:r},n.createElement("a",{id:"dlink"}),n.createElement("div",{id:"report-table"},n.createElement(p.i,{className:U?o:s},n.createElement(v.S,null,null===C||void 0===C||null===(t=C.programTrackedEntityAttributes)||void 0===t?void 0:t.map((e=>{var t,a;return n.createElement(E.p,{key:null===e||void 0===e||null===(t=e.trackedEntityAttribute)||void 0===t?void 0:t.id,style:{whiteSpace:"nowrap"},className:d},n.createElement("b",null,null===e||void 0===e||null===(a=e.trackedEntityAttribute)||void 0===a?void 0:a.name))}))),n.createElement(v.S,null,null===C||void 0===C||null===(a=C.programTrackedEntityAttributes)||void 0===a?void 0:a.map((e=>{var t,a,l;return n.createElement(n.Fragment,{key:null===e||void 0===e||null===(t=e.trackedEntityAttribute)||void 0===t?void 0:t.id},n.createElement(E.p,{key:null===e||void 0===e||null===(a=e.trackedEntityAttribute)||void 0===a?void 0:a.id,style:{whiteSpace:"nowrap"},className:U?`${m} ${d}`:` ${d}`},n.createElement("input",{type:"text",placeholder:`Search ${null===e||void 0===e||null===(l=e.trackedEntityAttribute)||void 0===l?void 0:l.name}`,onChange:t=>{var a,n,l;return n=null===e||void 0===e||null===(a=e.trackedEntityAttribute)||void 0===a?void 0:a.id,l=t.target.value,void B((e=>({...e,[n]:l})))}})))}))),N?n.createElement("div",null,n.createElement(y.Z,null)):n.createElement(g.R,null,(()=>{const e=10*J,t=e-10;if(void 0!==A){return A.filter((e=>Object.keys(R).every((t=>{const a=R[t],n=e.attributes.find((e=>e.attribute===t));return!a||n&&n.value.includes(a)})))).slice(t,e).map(((e,t)=>{var a;return n.createElement(v.S,{key:t,className:i},null===C||void 0===C||null===(a=C.programTrackedEntityAttributes)||void 0===a?void 0:a.map((t=>{var a;const l=e.attributes.find((e=>{var a;return e.attribute===(null===t||void 0===t||null===(a=t.trackedEntityAttribute)||void 0===a?void 0:a.id)})),r=e.trackedEntityInstance;return n.createElement(E.p,{key:null===t||void 0===t||null===(a=t.trackedEntityAttribute)||void 0===a?void 0:a.id,className:d},n.createElement("div",{onClick:()=>M({value:!0,id:r})},l?l.value:""))})))}))}return null})()))),n.createElement(f.Z,{activePage:J,itemsCountPerPage:10,totalItemsCount:x,pageRangeDisplayed:5,onChange:e=>{X(e)},itemClass:"page-item",linkClass:"page-link"})))))};const x={me:{resource:"me"}};var T=()=>n.createElement("div",null,n.createElement(l.ZR,{query:x},(e=>{let{error:t,loading:a,data:l}=e;return t?n.createElement("span",null,"ERROR"):a?n.createElement("span",null,"..."):n.createElement(n.Fragment,null,n.createElement(w,null))})))}}]);
//# sourceMappingURL=app.ba71f177.chunk.js.map